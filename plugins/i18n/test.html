<!DOCTYPE html
   PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title></title>

<script type="text/javascript" src="../../fleegix.js.uncompressed.js"></script>
<script type="text/javascript" src="i18n.js"></script>

<script type="text/javascript">

fakeFiles = {};
fakeFiles['en-us'] = {
  "Page.Title": "Japanese food and drink",
  "Food.Title": "Foods",
  "Food.Natto": "<a href=\"{0}\">Natto</a>",
  "Food.Basashi": "<a href=\"{0}\">Basashi</a>",
  "Drink.Title": "Drinks",
  "Drink.Sake": "<a href=\"{0}\">Sake</a>",
  "Drink.Shochu": "<a href=\"{0}\">Shochu</a>"
}
fakeFiles['ja-jp'] = {
  "Page.Title": "日本の食べ物・飲み物</a>",
  "Food.Title": "食べ物",
  "Food.Natto": "<a href=\"{0}\">納豆</a>",
  "Food.Basashi": "<a href=\"{0}\">馬刺し</a>",
  "Drink.Title": "飲み物",
  "Drink.Sake": "<a href=\"{0}\">日本酒</a>",
  "Drink.Shochu": "<a href=\"{0}\">焼酎</a>"
}

var _ = fleegix.i18n.getText;

function init() {
  i18nTest.renderPageByLanguage('en-us');
}

var i18nTest = new function () {
  this.setLanguage = function (lang) {
    fleegix.i18n.setLocalizedStrings(fakeFiles[lang]);
  }
  this.renderPageByLanguage = function (lang) {
    this.setLanguage(lang);
    this.renderPage();
  };
  this.renderPage = function () {
    document.title = _('Page.Title');
    var html = '';
    html += '<p>' + _('Food.Title') + '</p>';
    html += '<ul>';
    html += '<li>' + _('Food.Natto', 'http://images.google.com/images?q=natto') + '</li>';
    html += '<li>' + _('Food.Basashi', 'http://images.google.com/images?q=basashi') + '</li>';
    html += '</ul>';
    html += '<p>' + _('Drink.Title') + '</p>';
    html += '<ul>';
    html += '<li>' + _('Drink.Sake', 'http://images.google.com/images?q=sake') + '</li>';
    html += '<li>' + _('Drink.Shochu', 'http://images.google.com/images?q=shochu') + '</li>';
    html += '</ul>';
    $('content').innerHTML = html;
  };
  this.selectLanguage = function () {
    var selector = $('selectorForm').langSelector;
    var lang = selector.options[selector.selectedIndex].value
    this.renderPageByLanguage(lang);
  };
};

fleegix.event.listen(window, 'onload', init);

</script>

<style type="text/css">

*{
  font-family: "Lucida Grande", "Verdana", sans-serif;
}
</style>

</head>

<body>
  <div id="selectorFormContainer">
    <form id="selectorForm">
      <h3>
        Select a language
      </h3>
      <p>
        <select id="langSelector"
          onchange="i18nTest.selectLanguage();">
          <option value="en-us">
            US English
          </option>
          <option value="ja-jp">
            Japanese
          </option>
        </select>
      </p>
    </form>
  </div>
  <div id="content">
  </div>
</body>

</html>

